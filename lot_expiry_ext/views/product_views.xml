<?xml version="1.0" encoding="utf-8"?>

<odoo>

    <!-- <record id="view_production_lot_form_ext" model="ir.ui.view">
        <field name="name">stock.production.lot.ext.form</field>
        <field name="model">stock.production.lot</field>
        <field name="inherit_id" ref="stock.view_production_lot_form"/>
        <field name="arch" type="xml">
             <xpath expr="//field[@name='ref']" position="after" >
                <field name='expiration_date'/>
            </xpath>
        </field>
    </record> -->

    <record id="view_stock_production_lot_kanban" model="ir.ui.view">
        <field name="name">stock.production.lot.kanban</field>
        <field name="model">stock.production.lot</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                            <strong><field name="name"/></strong>
                            <field name="expiration_date"/>
                           <!--  <div class="row">
                                <div class="col-6">
                                    <field name="lot_id" invisible="not context.get('show_lots_m2o')" groups="stock.group_production_lot" context="{'default_product_id': product_id, 'active_picking_id': picking_id}"/>
                                    <field name="lot_name" invisible="not context.get('show_lots_text')" groups="stock.group_production_lot"/>
                                    <field name="qty_done" string="Quantity Done"/>
                                    <field name="product_uom_id" string="Unit of Measure" groups="uom.group_uom"/>
                                </div>
                                <div class="col-6 text-right">
                                    <field name="date"/>
                                </div>
                            </div> -->
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>


     <record id="product_expiry.view_stock_move_line_operation_tree_expiry" model="ir.ui.view">
        <field name="name">stock.move.line.inherit.tree</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="stock.view_stock_move_line_operation_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='lot_name']" position="after" >
                <field name="picking_type_use_existing_lots" invisible="1"/>
                <field name="expiration_date" force_save="1" attrs="{
                    'column_invisible': ['|', ('parent.use_expiration_date', '!=', True), ('parent.picking_code', 'not in', ('incoming', 'outgoing'))],
                    'readonly': [('picking_type_use_existing_lots', '=', True)],
                }"/>
            </xpath>
        </field>
    </record>

    <record id="product_expiry.view_stock_move_line_detailed_operation_tree_expiry" model="ir.ui.view">
        <field name="name">stock.move.line.operations.inherit.tree</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="stock.view_stock_move_line_detailed_operation_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='lot_name']" position="after">
                <field name="picking_type_use_existing_lots" invisible="1"/>
                <field name="expiration_date" force_save="1" attrs="{
                    'column_invisible': [('parent.picking_type_code', 'not in', ('incoming', 'outgoing'))],
                    'readonly': [('picking_type_use_existing_lots', '=', True)],
                }"/>
            </xpath>
        </field>
    </record>

    <record id="view_stock_move_line_kanban_ext" model="ir.ui.view">
        <field name="name">stock.move.line.kanban.ext</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="stock.view_stock_move_line_kanban"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='lot_id']" position="after">
                <field name="expiration_date"/>
            </xpath>
        </field>
    </record>

    <record id="view_move_line_form_ext" model="ir.ui.view">
        <field name="name">stock.move.line.form</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="stock.view_move_line_form"/>
        <field name="arch" type="xml">
             <xpath expr="//field[@name='lot_id']" position="after">
                <field name="expiration_date" groups="stock.group_production_lot"/>
            </xpath>
        </field>
    </record>

</odoo>