<odoo>
	<!-- Menu -->
	<record id="sale.menu_sale_report" model="ir.ui.menu">
		<field name="groups_id" eval="[(4, ref('to_sales_team_advanced.group_sale_team_leader'))]" />
	</record>

	<!-- Note: Access Rule:

	1. Group: User: Own Documents Only (sales_team.group_sale_salesman)
		- User only has Read/Write/Create permission with its document.
		- Has not Delete permission
	
	2. Group: Sales Team Leader (group_sale_team_leader)
		- User has Read/Write/Create permission with itself and team's document that it manages.
		-* User with team leader permission (maybe not leader) can Read/Write/Create all team's document.
		- User has Read/Write/Create permission with member's document that member has not in any team.
		- Has not Delete permission

	3. Group: Regional Manager (group_sale_regional_manager)
		- User has Read/Write/Create permission with itself and document of team and region that user manages.
		-* User with regional manager permission (maybe not regional manager) can Read/Write/Create all document of team or region that it in there.
		- User has Read/Write/Create permission with member's document that member has in any team and region.
		- Has not Delete permission

	4. Group: User: All Documents (sales_team.group_sale_salesman_all_leads)
		- Full permission with document of all teams except Delete permission

	5. Group: Administrator
		- Full permission

	-->

	<data noupdate="0">
		<!-- Sales Order Line Rules -->
		<record id="sale_order_line_salesteam_leader_rule" model="ir.rule">
			<field name="name">Sales Team Leader Order Lines</field>
			<field ref="sale.model_sale_order_line" name="model_id" />
			<field name="domain_force">['|', '|', '|', '|',
				('order_id.user_id.crm_team_ids.member_ids', 'in', [user.id]),
				('order_id.user_id.sale_team_id.user_id', '=', user.id),
				('order_id.team_id.member_ids', 'in', [user.id]),
				('order_id.team_id.user_id', '=', user.id),
				'&amp;',
					('order_id.team_id', '=', False),
					('order_id.crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_team_leader'))]" />
		</record>

		<record id="sale_order_line_regional_manager_rule" model="ir.rule">
			<field name="name">Regional Manager Orders Lines</field>
			<field ref="sale.model_sale_order_line" name="model_id" />
			<field name="domain_force">['|', '|', '|', '|', '|', '|', '|',
				('order_id.user_id.sale_team_id.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
				('order_id.user_id.sale_team_id.crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
				('order_id.user_id.sales_team_manager_ids.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
				('order_id.user_id.sales_region_manager_ids.recursive_user_ids', 'in', [user.id]),
				('order_id.user_id.sales_region_assistant_ids.recursive_user_ids', 'in', [user.id]),
				('order_id.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
				('order_id.crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
				('order_id.crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_regional_manager'))]" />
		</record>

		<!-- Sales Order Rules -->
		<record id="sale_order_salesteam_leader_rule" model="ir.rule">
			<field name="name">Sales Team Leader Orders</field>
			<field ref="sale.model_sale_order" name="model_id" />
			<field name="domain_force">['|', '|', '|', '|',
				('user_id.crm_team_ids.member_ids', 'in', [user.id]),
				('user_id.sale_team_id.user_id', '=', user.id),
				('team_id.member_ids', 'in', [user.id]),
				('team_id.user_id', '=', user.id),
				'&amp;',
					('team_id', '=', False),
					('crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_team_leader'))]" />
		</record>

		<record id="sale_order_regional_manager_rule" model="ir.rule">
			<field name="name">Regional Manager Orders</field>
			<field ref="sale.model_sale_order" name="model_id" />
			<field name="domain_force">['|', '|', '|', '|', '|', '|', '|',
				('user_id.sale_team_id.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
				('user_id.sale_team_id.crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
				('user_id.sales_team_manager_ids.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
				('user_id.sales_region_manager_ids.recursive_user_ids', 'in', [user.id]),
				('user_id.sales_region_assistant_ids.recursive_user_ids', 'in', [user.id]),
				('crm_team_region_id.recursive_user_ids', 'in', [user.id]),
				('crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
				('crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_regional_manager'))]" />
		</record>

		<!-- Sales Order Report -->
		<record id="sale_order_report_salesteam_leader_rule" model="ir.rule">
			<field name="name">Sales Team Leader Orders Analysis</field>
			<field ref="sale.model_sale_report" name="model_id" />
			<field name="domain_force">['|', '|', '|', '|',
				('user_id.crm_team_ids.member_ids', 'in', [user.id]),
				('user_id.sale_team_id.user_id', '=', user.id),
				('team_id.member_ids', 'in', [user.id]),
				('team_id.user_id', '=', user.id),
				'&amp;',
					('team_id', '=', False),
					('crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_team_leader'))]" />
		</record>

		<record id="sale_order_report_regional_manager_rule" model="ir.rule">
			<field name="name">Regional Manager Orders Analysis</field>
			<field ref="sale.model_sale_report" name="model_id" />
			<field name="domain_force">['|', '|', '|', '|', '|', '|', '|',
				('user_id.sale_team_id.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
				('user_id.sale_team_id.crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
				('user_id.sales_team_manager_ids.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
				('user_id.sales_region_manager_ids.recursive_user_ids', 'in', [user.id]),
				('user_id.sales_region_assistant_ids.recursive_user_ids', 'in', [user.id]),
				('crm_team_region_id.recursive_user_ids', 'in', [user.id]),
				('crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
				('crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_regional_manager'))]" />
		</record>

		<!-- Account Move -->
		<record id="account_move_team_leader_rule" model="ir.rule">
			<field name="name">Team Leader Invoice</field>
			<field ref="model_account_move" name="model_id" />
			<field name="domain_force">[
				('move_type', 'in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund')),
				'|', '|', '|', '|',
					('invoice_user_id.crm_team_ids.member_ids', 'in', [user.id]),
					('invoice_user_id.sale_team_id.user_id', '=', user.id),
					('team_id.member_ids', 'in', [user.id]),
					('team_id.user_id', '=', user.id),
					'&amp;',
						('team_id', '=', False),
						('crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_team_leader'))]" />
		</record>

		<record id="account_move_regional_manager_rule" model="ir.rule">
			<field name="name">Regional Manager Invoice</field>
			<field ref="model_account_move" name="model_id" />
			<field name="domain_force">[
				('move_type', 'in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund')),
				'|', '|', '|', '|', '|', '|', '|',
					('invoice_user_id.sale_team_id.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
					('invoice_user_id.sale_team_id.crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
					('invoice_user_id.sales_team_manager_ids.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
					('invoice_user_id.sales_region_manager_ids.recursive_user_ids', 'in', [user.id]),
					('invoice_user_id.sales_region_assistant_ids.recursive_user_ids', 'in', [user.id]),
					('crm_team_region_id.recursive_user_ids', 'in', [user.id]),
					('crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
					('crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_regional_manager'))]" />
		</record>

		<!-- Account Move Line -->
		<record id="account_move_line_team_leader_rule" model="ir.rule">
			<field name="name">Team Leader Invoice Lines</field>
			<field ref="sale.model_account_move_line" name="model_id" />
			<field name="domain_force">[
				('move_id.move_type', 'in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund')),
				'|', '|', '|', '|',
					('move_id.invoice_user_id.crm_team_ids.member_ids', 'in', [user.id]),
					('move_id.invoice_user_id.sale_team_id.user_id', '=', user.id),
					('move_id.team_id.member_ids', 'in', [user.id]),
					('move_id.team_id.user_id', '=', user.id),
					'&amp;',
						('move_id.team_id', '=', False),
						('move_id.crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_team_leader'))]" />
		</record>

		<record id="account_move_line_regional_manager_rule" model="ir.rule">
			<field name="name">Regional Manager Invoice Lines</field>
			<field ref="sale.model_account_move_line" name="model_id" />
			<field name="domain_force">[
				('move_id.move_type', 'in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund')),
				'|', '|', '|', '|', '|', '|', '|',
					('move_id.invoice_user_id.sale_team_id.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
					('move_id.invoice_user_id.sale_team_id.crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
					('move_id.invoice_user_id.sales_team_manager_ids.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
					('move_id.invoice_user_id.sales_region_manager_ids.recursive_user_ids', 'in', [user.id]),
					('move_id.invoice_user_id.sales_region_assistant_ids.recursive_user_ids', 'in', [user.id]),
					('move_id.crm_team_region_id.recursive_user_ids', 'in', [user.id]),
					('move_id.crm_team_region_id.recursive_assistant_ids', 'in', [user.id]),
					('move_id.crm_team_region_id', '=', False)]
			</field>
			<field name="groups" eval="[(4, ref('to_sales_team_advanced.group_sale_regional_manager'))]" />
		</record>
	</data>
</odoo>
